<:-.wrap "admin/base.tmpl", "title":"Edit Coupon" :>
<div class="window dialog">
  <header>
    <h1><:= params.title :></h1>
    <a href="<:= cfg.admin_url("menu") :>" accesskey="m" title="AccessKey = m" data-widget="close">Quick Launch</a>
  </header>
  <:-.set object = coupon :>
  <form action="<:= cfg.admin_url("shopadmin") :>" method="post" data-object="Coupon">
    <input type="hidden" name="id" value="<:= coupon.id :>" />
    <:csrfp admin_bse_coupon_edit hidden :>
    <:-.if coupon.is_expired :>
    <p data-role="status" class="error">This coupon has expired, modify its expiry date before use</p>
    <:-.elsif !coupon.is_removable :>
    <p data-role="status" class="warning">This coupon has been used, its code cannot be modified</p>
    <:-.end if :>
    <fieldset>
      <legend>Coupon</legend>
      <:.call "field", "name":"code", "autofocus":1 :>
      <:.call "field", "name":"description" :>
      <:.call "field", "name":"discount_percent", "placeholder":"%" :>
      <:.call "field", "name":"campaign" :>
    </fieldset>
    <fieldset>
      <legend>Validity</legend>
      <:.call "field", "name":"release", "placeholder":"DD/MM/YYYY" :>
      <:.call "field", "name":"expiry", "placeholder":"DD/MM/YYYY" :>
    </fieldset>
    <:-.if tiers.size != 0 :>
    <:.call "fieldset", "name":"tiers" :>
    <:-.else :>
    <input type="hidden" name="tiers" value="0" />
    <:-.end if :>
    <p class="buttons">
      <a href="<:switch:><:case Cgi r:><:cgi r:><:case And [cgi referer] [referer]:><:replace [referer] "&amp;referer=[0-9]+":><:case default:><:adminurl menu:><:endswitch:>" accesskey="." title="AccessKey = ." data-action="Cancel" class="button white">Cancel</a>
      <input type="submit" name="a_coupon_save" value="Save Changes" accesskey="s" title="AccessKey = s" class="button green" />
    </p>
  </form>
</div>